@model DoctorViewModel

<h2>Add New Doctor</h2>

<form asp-action="Add" method="post" class="form-horizontal">
    
    <h4>Personal Information</h4>
    <div class="form-group">
        <label>FirstName</label>
        <input asp-for="FirstName" class="form-control" />
    </div>
     <div class="form-group">
        <label>LastName</label>
        <input asp-for="LastName" class="form-control" />
    </div>
    <div class="form-group">
        <label>Email</label>
        <input asp-for="Email" type="email" class="form-control" />
    </div>
    <div class="form-group">
        <label>Password</label>
        <input asp-for="Password" type="password" class="form-control" />
    </div>
   

    <hr />

    <h4>Professional Details</h4>
    <div class="form-group">
        <label>Specialization</label>
        <input asp-for="Specialization" class="form-control" />
    </div>
    <div class="form-group">
        <label>Department</label>
        <input asp-for="Department" class="form-control" />
    </div>
    <div class="form-group">
        <label>Years of Experience</label>
        <input asp-for="YearsOfExperience" type="number" class="form-control" />
    </div>

    <hr />

<h4>Enter Your Time Slots</h4>
    
    <table class="table" id="scheduleTable">
        <thead>
        <tr>
            <th>Date & Time (Start)</th>
            <th>Date & Time (End)</th>
            <th></th>
        </tr>
        </thead>
        <tbody id="scheduleBody">
        </tbody>
    </table>

    <button type="button" class="btn btn-secondary" onclick="addScheduleRow()">+ Add Shift</button>    
    <hr />

<script>
    let index = 0;


    function addScheduleRow(startVal = "", endVal = "") {
        const tableBody = document.getElementById("scheduleBody");

        const row = `
        <tr>
            <td>
                <input type="datetime-local" name="Schedules[${index}].StartTime" 
                       value="${startVal}" class="form-control" required />
            </td>
            <td>
                <input type="datetime-local" name="Schedules[${index}].EndTime" 
                       value="${endVal}" class="form-control" required />
            </td>
            <td>
                <button type="button" class="btn btn-danger btn-sm" onclick="removeRow(this)">Remove</button>
            </td>
        </tr>
    `;

        tableBody.insertAdjacentHTML('beforeend', row);
        index++;
    }

    // Logic to load existing data from the Model
    document.addEventListener("DOMContentLoaded", function() {
        @if (Model.Schedules != null && Model.Schedules.Any())
        {
        foreach (var item in Model.Schedules)
        {
        var start = item.StartTime.ToString("yyyy-MM-ddTHH:mm");
        var end = item.EndTime.ToString("yyyy-MM-ddTHH:mm");

        @:addScheduleRow("@start", "@end");
        }
        }
        else
        {
        // Add one empty row if no data exists
        @:addScheduleRow();
        }
    });
    function removeRow(btn) {

        var row = btn.closest('tr');
        row.remove();
       
    }

    document.addEventListener("DOMContentLoaded", function() {
        addScheduleRow();
    });
</script>

    <br />
    <button type="submit" class="btn btn-primary">Save Doctor</button>
</form>